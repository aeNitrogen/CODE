import torch
import matplotlib.pyplot as plt
import wandb
from scipy.signal import savgol_filter
# plt.style.use('dark_background')

dpi=300


names = [
    "Nlinear",
    "Dlinear",
    "Lstm",
    "Transformer",
    "Autoformer",
    "Informer",
    "Informer+",
    "PatchTST"
]

sin_steps = [50,100,150,200,250,300,350,400,450,500,550,600,650,700,750]
M_steps = [50,100,150,200,250,300,350]
C_steps = [50,100,150,200,250,300]


sinmix= [
    [0.30385661779819534,0.8340798314048773,1.1657003281174496,1.412017685463533,1.6431488621643688,1.814923499990864,1.8093771037129296,1.7028401261522395,1.6046506765248438,1.490347626131381,1.3709143681948481,1.3501816423908304,1.4040804052088927,1.4685228816369587,1.5980681500117253],
    [0.05473950987433117,0.09887729465441691,0.11117521753434646,0.11667955076245248,0.11921270269537405,0.12222273927134254,0.12741749391602153,0.13734661235527124,0.14677023960615085,0.15493057291978013,0.15768697377618082,0.1585560882097393,0.16134551509660122,0.16237902953000558,0.17743963741712068],
    [0.6448808721371418,0.5612205176341238,0.526625894600333,0.5139619150440021,0.5035817832041128,0.5039002238643505,0.509559920124928,0.5114882490413116,0.5358016422634009,0.563499340092828,0.5901275856126209,0.6282869487858883,0.6556743522301486,0.704581785545418,0.7644781365084145],
    [0.21414154056166615,0.2156468268479886,0.2212452070488815,0.23128990059226975,0.22613295881558299,0.21944769431584724,0.2230194037041929,0.21795046261823545,0.22607434335514812,0.23316346104114136,0.23266876741130524,0.24528379714184959,0.25679557067199044,0.2728171457435845,0.2888602980097571],
    [0.7556121478789771,0.6764325520030671,0.759164146707758,0.9292614893256569,1.0320396595100734,1.079822188505423,1.101884762152335,0.9689374143375613,0.8085629424649473,0.8416714775910872,0.9100967015392292,1.1057285438352429,1.1587238531478103,1.1171001249764427,0.9416003344070327],
    [0.2059653707964952,0.19826051002501147,0.18589341691001338,0.1901882673147696,0.1781531396501323,0.18054032907797263,0.18316808779707006,0.2004334837705629,0.20511477258720048,0.23691604694411528,0.22436135772656657,0.2447516445167284,0.2559466081286728,0.27423200780942214,0.25306151693795914],
    [0.16549599149718422,0.16140391368794837,0.15570408029722593,0.16056480800494288,0.15472993030179719,0.1597557401121725,0.1500508159086003,0.16485358110114343,0.1618079475389314,0.16929209974255593,0.16576139990191516,0.17187409305353044,0.1625530596259347,0.18403402870140576,0.17569979545482106],
    [0.06039873861215662,0.0812164418811272,0.09553613657378354,0.10317548497106968,0.10890308385040992,0.1155908796378917,0.12030174576833837,0.12622177444643426,0.12995200065084772,0.1308236462746933,0.13151801842854507,0.1331608834816551,0.13337131332138485,0.13805251458424384,0.14704740589975684],
]  # final

sin = [
    [0.02629241888657662,0.06290766942432036,0.1104193094042429,0.16945345885566132,0.24378830689972436,0.3208161536629097,0.4086439453659242,0.5019413364922557,0.6010431795442821,0.6986575790067749,0.798172530927921,0.88984250666682,0.9747775335503537,1.0558024000627475,1.1278857030492044],
    [0.009918642189251228,0.014535332624967225,0.01937850809060801,0.0243855681141093,0.029171548977992196,0.0337635180815582,0.03867611518532041,0.04306589302145052,0.04758891559897995,0.05230467659770048,0.05574239135748585,0.06076177291009566,0.06466335885140295,0.06863057917005619,0.07280385281839657],
    [0.7448216481427927,0.7301328222398216,0.7303108982112843,0.7411727616111706,0.7598084081484019,0.7667167741205979,0.7792723584608964,0.7873551354445395,0.8102395881298361,0.829935964020001,0.8547032151123279,0.8831739247924382,0.9166944379668861,0.9431744739229918,0.9671257527589961],
    [0.12413981595665685,0.12757926404881373,0.1293257361527577,0.1290886718717865,0.12703673811323749,0.12506817665943737,0.12325173239603757,0.12192392615172404,0.12444072635514665,0.12110193501697615,0.12408350278557066,0.12690062333146027,0.12859734366469766,0.13097055035943558,0.13223644460655734],
    [0.8901271330046897,0.8288164632025238,0.7088135632755073,0.5872649570136601,0.47819345170865385,0.3883865250600511,0.3815105903887146,0.4438284851841071,0.4722026870651458,0.39178446872753103,0.4024273160980276,0.5117477200709576,0.5679577385975716,0.5273538279867246,0.5279388522048204],
    [0.06394021837193992,0.06853598618203989,0.05824326562612819,0.06217255680741429,0.06407583986389319,0.06520839828534301,0.07066086934913711,0.07604763168645784,0.07622091041807363,0.08213640563447966,0.09021383694764479,0.09649920004026573,0.10303528509464065,0.10887945897064007,0.11682526573038418],
    [0.05390674230914163,0.046494982539233815,0.04889594232297377,0.05594894172721711,0.05733139378408481,0.05463238625482056,0.05398700375548256,0.06599374017356778,0.06032286538996849,0.0603147120953376,0.06534706959885195,0.0753065520712994,0.07250666428230712,0.07441432758264802,0.08808543091417338],
    [0.014958595584680792,0.01780942755221863,0.02143745543792025,0.025875626290367295,0.030444088135658826,0.03534119708838622,0.039981869486049135,0.04523668314264607,0.050260887324660435,0.055324274941857245,0.06022488282592928,0.06566449545080487,0.07060694261595676,0.07592700670710636,0.0811825238301182],
]

cheetah = [
    [0.3878128230571747,0.48492997884750366,0.5685985088348389,0.6199250221252441,0.6529169082641602,0.6681619882583618],
    [0.386436402797699,0.45257821679115295,0.4989670217037201,0.5250224471092224,0.5477123260498047,0.5646941661834717],
    [0.2559731602668762,0.28564468026161194,0.30397042632102966,0.32755622267723083,0.345386266708374,0.35746246576309204],
    [0.20219580829143524,0.2336670607328415,0.26616382598876953,0.28825247287750244,0.30823972821235657,0.32028302550315857],
    [0.36587581038475037,0.40186357498168945,0.41560670733451843,0.4372568428516388,0.4574526846408844,0.47801992297172546],
    [0.268463134765625,0.32027924060821533,0.364459365606308,0.3932451605796814,0.41944563388824463,0.43668556213378906],
    [0.2599402368068695,0.28425803780555725,0.3088669776916504,0.3579956591129303,0.35239797830581665,0.3628993034362793],
    [0.39633381366729736,0.4549758732318878,0.4969460964202881,0.5204049348831177,0.5436623692512512,0.560204029083252],
]

maze = [
    [0.36031365394592285,0.4798722565174103,0.6095905303955078,0.7175294756889343,0.8031831383705139,0.8765508532524109,0.9440858364105225],
    [0.19501911103725433,0.5233664512634277,0.7993114590644836,0.9847273826599121,1.0984163284301758,1.1712409257888794,1.2304800748825073],
    [0.18639974296092987,0.5133238434791565,0.7907454371452332,0.9776234030723572,1.0927575826644897,1.1665256023406982,1.226294755935669],
    [0.35075321793556213,0.3756119906902313,0.49173247814178467,0.6162822246551514,0.7250403761863708,0.8189682364463806,0.897660493850708],
    [0.8307328224182129,0.9782904386520386,1.050408124923706,1.109832525253296,1.1831839084625244,1.222602367401123,1.2452104091644287],
    [0.1495978832244873,0.2639058530330658,0.4032105505466461,0.5364551544189453,0.6557472944259644,0.7638377547264099,0.8511311411857605],
    [0.14582934975624084,0.27156588435173035,0.40857598185539246,0.5368943214416504,0.6502976417541504,0.7482536435127258,0.8319694995880127],
    [0.16733738780021667,0.47322264313697815,0.7405035495758057,0.924243688583374,1.0408599376678467,1.1202201843261719,1.1862589120864868],
]

special_lstm = [
    [0.6448808721371418, 0.5612205176341238, 0.526625894600333, 0.5139619150440021, 0.5035817832041128,
     0.5039002238643505, 0.509559920124928, 0.5114882490413116, 0.5358016422634009, 0.563499340092828,
     0.5901275856126209, 0.6282869487858883, 0.6556743522301486, 0.704581785545418, 0.7644781365084145],
    [0.9849494774178791,0.9876738853691236,0.9765242096536135,0.95258713136134,0.9651575521450757,0.9698321331130106]
]

def plot_mix():
    plt.figure(dpi=dpi)
    for i in range(len(names)):
        plt.plot(sin_steps, sinmix[i], label=names[i], linewidth=3)
    ax = plt.gca()
    plt.xlabel("steps")
    plt.ylabel("RMSE")
    ax.set_ylim([0, 0.3])
    plt.legend()
    plt.show()


def plot_sin():
    plt.figure(dpi=dpi)
    for i in range(len(names)):
        plt.plot(sin_steps, sin[i], label=names[i], linewidth=3)
    ax = plt.gca()
    ax.set_ylim([0, 0.3])
    plt.xlabel("steps")
    plt.ylabel("RMSE")
    plt.legend()
    plt.show()

def plot_C():
    plt.figure(dpi=dpi)
    for i in range(len(names)):
        plt.plot(C_steps, cheetah[i], label=names[i], linewidth=3)
    ax = plt.gca()
    #ax.set_ylim([0, 0.3])
    plt.xlabel("steps")
    plt.ylabel("RMSE")
    plt.legend()
    plt.savefig("cheetah_error")
    plt.show()

def plot_M():
    plt.figure(dpi=dpi)
    for i in range(len(names)):
        plt.plot(M_steps, maze[i], label=names[i], linewidth=3)
    ax = plt.gca()
    # ax.set_ylim([0, 0.3])
    plt.xlabel("steps")
    plt.ylabel("RMSE")
    plt.legend()
    plt.savefig("maze_eot")
    plt.show()

def plot_special():
    plt.figure(dpi=dpi)
    names_s = ["prediction length 750", "prediction length 300"]
    print("saved!")
    for i in range(len(names_s)):
        plt.plot(sin_steps[:len(special_lstm[i])], special_lstm[i], label=names_s[i], linewidth=3)
    print("saved!")
    plt.xlabel("steps")
    plt.ylabel("RMSE")
    plt.legend()
    # plt.savefig("special_lstm")
    plt.show()
    print("saved!")
    # something is wrong here do not use

plot_M()
plot_C()